// Test multiple field accesses in same expression to isolate verifier error
// This tests the exact pattern from new_features.kn that might be causing issues

// Product type with multiple fields (same as new_features.kn)
type User = User(id: Int, name: String, email: String, age: Int)

// Create a user
alice: User = User(id: 1, name: "Alice", email: "alice@test.com", age: 25)

// Test 1: Single field access
get_id(user: User): Int = {
    user.id
}

// Test 2: Two field accesses in same function
get_id_and_age(user: User): Int = {
    id_val = user.id
    age_val = user.age
    id_val + age_val
}

// Test 3: Multiple field accesses in constructor (this might be the issue!)
update_user_simple(user: User, new_name: String): User = {
    User(id: user.id, name: new_name, email: user.email, age: user.age)
}

// Test 4: Same as test 3 but with live parameter
update_user_live(live user: User, new_name: String): User = {
    User(id: user.id, name: new_name, email: user.email, age: user.age)
}

// Test 5: Break down the constructor call to isolate the issue
update_user_step_by_step(user: User, new_name: String): User = {
    id_val = user.id
    email_val = user.email
    age_val = user.age

    User(id: id_val, name: new_name, email: email_val, age: age_val)
}

// Main function
main(): Int = {
    // Test simple field access
    id = get_id(alice)

    // Test multiple field accesses
    combined = get_id_and_age(alice)

    // Test constructor with field access (most likely to fail)
    updated = update_user_simple(alice, "Bob")

    // Return success
    id + combined
}
